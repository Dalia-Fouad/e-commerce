import{a as A}from"./chunk-67WC2ZER.js";import{a as E,b as y,c as k,d as D,h as T,i as q,j as F,k as N,m as R}from"./chunk-Z6CYM7GD.js";import{a as x}from"./chunk-K54GASPR.js";import{e as I,g as O}from"./chunk-QD6CZ7NI.js";import{$ as b,Ab as s,Hb as S,Ma as l,Y as f,bb as d,db as _,hb as m,lb as o,mb as i,nb as g,sb as v,tb as C}from"./chunk-7M6V4D3V.js";function w(t,r){t&1&&(o(0,"p",13),s(1,"details required"),i())}function G(t,r){if(t&1&&(o(0,"div",6),d(1,w,2,0,"p",13),i()),t&2){let p,e=C();l(),m(1,(p=e.shippingInfo.get("details"))!=null&&p.getError("required")?1:-1)}}function M(t,r){t&1&&(o(0,"p",13),s(1,"phone required"),i())}function V(t,r){if(t&1&&(o(0,"div",6),d(1,M,2,0,"p",13),i()),t&2){let p,e=C();l(),m(1,(p=e.shippingInfo.get("phone"))!=null&&p.getError("required")?1:-1)}}function B(t,r){t&1&&(o(0,"p",13),s(1,"city is required"),i())}function j(t,r){if(t&1&&(o(0,"div",6),d(1,B,2,0,"p",13),i()),t&2){let p,e=C();l(),m(1,(p=e.shippingInfo.get("city"))!=null&&p.getError("required")?1:-1)}}var W=(()=>{let r=class r{constructor(){this._FormBuilder=f(N),this._ActivatedRoute=f(I),this._OrdersService=f(A),this._Router=f(O),this._CartService=f(x),this.shippingInfo=this._FormBuilder.group({details:[null,[y.required]],phone:[null,[y.required]],city:[null,[y.required]]}),this.cartID="",this.type=""}ngOnInit(){this.paramSubscription=this._ActivatedRoute.paramMap.subscribe({next:e=>{this.cartID=e.get("id")},error:e=>{console.log(e.error.message)}})}ngOnDestroy(){this.paramSubscription?.unsubscribe()}checkOut(){this.type=="visa"?this._OrdersService.checkOutSession(this.cartID,this.shippingInfo.value).subscribe({next:e=>{console.log(e),e.status=="success"&&window.open(e.session.url,"_self")},error:e=>{console.log(e.error.message)}}):this.type=="cash"&&(console.log("cashhhhhhhhhh"),this._OrdersService.cashOrder(this.cartID,this.shippingInfo.value).subscribe({next:e=>{console.log(this.cartID),console.log(e),e.status=="success"&&(this._CartService.removeAllCartItems().subscribe({next:c=>{console.log(c),this._CartService.numberOfCartItems.set(0)}}),this._Router.navigate(["/allorders"]))},error:e=>{console.log(this.cartID),console.log(e.error.message)}}))}};r.\u0275fac=function(c){return new(c||r)},r.\u0275cmp=b({type:r,selectors:[["app-orders"]],standalone:!0,features:[S],decls:23,vars:6,consts:[[1,"container","w-75","mx-auto","my-5"],[1,"text-main"],[3,"ngSubmit","formGroup"],[1,"my-2"],["for","details"],["type","text","id","details","formControlName","details",1,"form-control"],[1,"alert","alert-danger","w-100","mt-1"],["for","phone"],["type","tel","id","phone","formControlName","phone",1,"form-control"],["for","city"],["type","city","id","city","formControlName","city",1,"form-control"],["type","submit",1,"btn-main","my-3",3,"click","disabled"],["type","submit",1,"btn-main","my-3","ms-3",3,"click","disabled"],[1,"m-0"]],template:function(c,n){if(c&1&&(o(0,"section",0)(1,"h3",1),s(2,"Shipping Address :"),i(),o(3,"form",2),v("ngSubmit",function(){return n.checkOut()}),o(4,"div",3)(5,"label",4),s(6,"details:"),i(),g(7,"textarea",5),d(8,G,2,1,"div",6),i(),o(9,"div",3)(10,"label",7),s(11,"phone:"),i(),g(12,"input",8),d(13,V,2,1,"div",6),i(),o(14,"div",3)(15,"label",9),s(16,"city:"),i(),g(17,"input",10),d(18,j,2,1,"div",6),i(),o(19,"button",11),v("click",function(){return n.type="visa"}),s(20," Check out Visa"),i(),o(21,"button",12),v("click",function(){return n.type="cash"}),s(22," Check out Cash"),i()()()),c&2){let a,u,h;l(3),_("formGroup",n.shippingInfo),l(5),m(8,(a=n.shippingInfo.get("details"))!=null&&a.errors&&((a=n.shippingInfo.get("details"))!=null&&a.touched||(a=n.shippingInfo.get("details"))!=null&&a.dirty)?8:-1),l(5),m(13,(u=n.shippingInfo.get("phone"))!=null&&u.errors&&((u=n.shippingInfo.get("phone"))!=null&&u.touched||(u=n.shippingInfo.get("phone"))!=null&&u.dirty)?13:-1),l(5),m(18,(h=n.shippingInfo.get("city"))!=null&&h.errors&&((h=n.shippingInfo.get("city"))!=null&&h.touched||(h=n.shippingInfo.get("city"))!=null&&h.dirty)?18:-1),l(),_("disabled",n.shippingInfo.invalid),l(2),_("disabled",n.shippingInfo.invalid)}},dependencies:[R,T,E,k,D,q,F]});let t=r;return t})();export{W as OrdersComponent};
