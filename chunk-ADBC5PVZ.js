import{a as b}from"./chunk-OGPXQLBF.js";import{a as T,b as c,c as V,d as M,h as q,i as N,j as R,k as A,m as G}from"./chunk-Z6CYM7GD.js";import{g as y}from"./chunk-QD6CZ7NI.js";import{$ as P,Ab as l,Bb as F,Hb as h,Kb as E,Ma as a,Y as C,bb as u,db as p,hb as _,hc as S,ja as f,ka as w,lb as n,mb as i,nb as g,qb as x,sb as v,tb as m}from"./chunk-7M6V4D3V.js";var B=(o,r)=>({"is-valid":o,"is-invalid":r});function D(o,r){o&1&&(n(0,"p",11),l(1,"email is required"),i())}function I(o,r){o&1&&(n(0,"p",11),l(1,"Enter Valid Email "),i())}function k(o,r){if(o&1&&(n(0,"div",7),u(1,D,2,0,"p",11)(2,I,2,0),i()),o&2){let e,t=m(2);a(),_(1,(e=t.forgotPasswordForm.get("email"))!=null&&e.getError("required")?1:(e=t.forgotPasswordForm.get("email"))!=null&&e.getError("email")?2:-1)}}function $(o,r){if(o&1&&(n(0,"div",10),l(1),i()),o&2){let e=m(2);a(),F(e.errorMessage)}}function j(o,r){if(o&1){let e=x();n(0,"form",3),v("ngSubmit",function(){f(e);let d=m();return w(d.verifyEmail())}),n(1,"div",4)(2,"label",5),l(3,"Enter Your Email :"),i(),g(4,"input",6),u(5,k,3,1,"div",7),i(),n(6,"span",8),l(7," a verfication code will be sent to this email "),i(),n(8,"button",9),l(9," Next "),i(),u(10,$,2,1,"div",10),i()}if(o&2){let e,t=m();p("formGroup",t.forgotPasswordForm),a(5),_(5,(e=t.forgotPasswordForm.get("email"))!=null&&e.errors&&((e=t.forgotPasswordForm.get("email"))!=null&&e.touched||(e=t.forgotPasswordForm.get("email"))!=null&&e.dirty)?5:-1),a(3),p("disabled",t.isloading||t.forgotPasswordForm.invalid),a(2),_(10,t.errorMessage?10:-1)}}function U(o,r){o&1&&(n(0,"p",11),l(1,"resetCode is required"),i())}function Y(o,r){o&1&&(n(0,"p",11),l(1,"Enter Valid Code "),i())}function z(o,r){if(o&1&&(n(0,"div",7),u(1,U,2,0,"p",11)(2,Y,2,0),i()),o&2){let e,t=m(2);a(),_(1,(e=t.verifyCodeForm.get("resetCode"))!=null&&e.getError("required")?1:(e=t.verifyCodeForm.get("resetCode"))!=null&&e.getError("pattern")?2:-1)}}function H(o,r){if(o&1&&(n(0,"div",10),l(1),i()),o&2){let e=m(2);a(),F(e.errorMessage)}}function J(o,r){if(o&1){let e=x();n(0,"form",3),v("ngSubmit",function(){f(e);let d=m();return w(d.verifyResetCode())}),n(1,"div",4)(2,"label",12),l(3,"Enter verfication code :"),i(),g(4,"input",13),u(5,z,3,1,"div",7),i(),n(6,"button",9),l(7," next "),i(),u(8,H,2,1,"div",10),i()}if(o&2){let e,t=m();p("formGroup",t.verifyCodeForm),a(5),_(5,(e=t.verifyCodeForm.get("resetCode"))!=null&&e.errors&&((e=t.verifyCodeForm.get("resetCode"))!=null&&e.touched||(e=t.verifyCodeForm.get("resetCode"))!=null&&e.dirty)?5:-1),a(),p("disabled",t.isloading),a(2),_(8,t.errorMessage?8:-1)}}function K(o,r){o&1&&(n(0,"p",11),l(1,"email is required"),i())}function L(o,r){o&1&&(n(0,"p",11),l(1,"Enter Valid Email "),i())}function O(o,r){if(o&1&&(n(0,"div",7),u(1,K,2,0,"p",11)(2,L,2,0),i()),o&2){let e,t=m(2);a(),_(1,(e=t.resetPasswordForm.get("email"))!=null&&e.getError("required")?1:(e=t.resetPasswordForm.get("email"))!=null&&e.getError("email")?2:-1)}}function Q(o,r){o&1&&(n(0,"p",11),l(1,"password is required"),i())}function W(o,r){o&1&&(n(0,"p",11),l(1,"must be at least 6 chars"),i())}function X(o,r){if(o&1&&(n(0,"div",7),u(1,Q,2,0,"p",11)(2,W,2,0),i()),o&2){let e,t=m(2);a(),_(1,(e=t.resetPasswordForm.get("newPassword"))!=null&&e.getError("required")?1:(e=t.resetPasswordForm.get("newPassword"))!=null&&e.getError("pattern")?2:-1)}}function Z(o,r){if(o&1&&(n(0,"div",10),l(1),i()),o&2){let e=m(2);a(),F(e.errorMessage)}}function ee(o,r){if(o&1){let e=x();n(0,"form",3),v("ngSubmit",function(){f(e);let d=m();return w(d.resetPassword())}),n(1,"div",4)(2,"label",14),l(3,"email:"),i(),g(4,"input",15),u(5,O,3,1,"div",7),i(),n(6,"div",4)(7,"label",16),l(8,"new password:"),i(),g(9,"input",17),u(10,X,3,1,"div",7),i(),n(11,"button",9),l(12," Reset Password "),i(),u(13,Z,2,1,"div",10),i()}if(o&2){let e,t,d,s=m();p("formGroup",s.resetPasswordForm),a(4),p("ngClass",E(6,B,!((e=s.resetPasswordForm.get("email"))!=null&&e.errors)&&(((e=s.resetPasswordForm.get("email"))==null?null:e.touched)||((e=s.resetPasswordForm.get("email"))==null?null:e.dirty)),((e=s.resetPasswordForm.get("email"))==null?null:e.errors)&&(((e=s.resetPasswordForm.get("email"))==null?null:e.touched)||((e=s.resetPasswordForm.get("email"))==null?null:e.dirty)))),a(),_(5,(t=s.resetPasswordForm.get("email"))!=null&&t.errors&&((t=s.resetPasswordForm.get("email"))!=null&&t.touched||(t=s.resetPasswordForm.get("email"))!=null&&t.dirty)?5:-1),a(5),_(10,(d=s.resetPasswordForm.get("newPassword"))!=null&&d.errors&&((d=s.resetPasswordForm.get("newPassword"))!=null&&d.touched||(d=s.resetPasswordForm.get("newPassword"))!=null&&d.dirty)?10:-1),a(),p("disabled",s.isloading),a(2),_(13,s.errorMessage?13:-1)}}var de=(()=>{let r=class r{constructor(){this._FormBuilder=C(A),this._AuthService=C(b),this._Router=C(y),this.step=1,this.isloading=!1,this.errorMessage="",this.forgotPasswordForm=this._FormBuilder.group({email:[null,[c.required,c.email]]}),this.verifyCodeForm=this._FormBuilder.group({resetCode:[null,[c.required,c.pattern(/^\w{6}$/)]]}),this.resetPasswordForm=this._FormBuilder.group({email:[null,[c.required,c.email]],newPassword:[null,[c.required,c.pattern(/^\w{6,}$/)]]})}verifyEmail(){this.isloading=!0,this.resetPasswordForm.get("email")?.patchValue(this.forgotPasswordForm.get("email")?.value),this._AuthService.forgotPassword(this.forgotPasswordForm.value).subscribe({next:t=>{this.isloading=!1,console.log(t),t.statusMsg==="success"&&(this.step=2)},error:t=>{this.isloading=!1,console.log(t.error.message),this.errorMessage=t.error.message}})}verifyResetCode(){this._AuthService.verifyResetCode(this.verifyCodeForm.value).subscribe({next:t=>{console.log(t),t.status==="Success"&&(this.step=3)},error:t=>{console.log(t.error.message),this.errorMessage=t.error.message}})}resetPassword(){this._AuthService.resetPassword(this.resetPasswordForm.value).subscribe({next:t=>{console.log(t),localStorage.setItem("userToken",t.token),this._AuthService.saveUserData(),this._Router.navigate(["/home"])},error:t=>{console.log(t.error.message),this.errorMessage=t.error.message}})}};r.\u0275fac=function(d){return new(d||r)},r.\u0275cmp=P({type:r,selectors:[["app-forgot-password"]],standalone:!0,features:[h],decls:7,vars:1,consts:[[1,"container","w-50","bg-light","rounded-3","p-4","shadow"],[1,"text-main","fw-bold","text-center","mb-4"],[3,"formGroup"],[3,"ngSubmit","formGroup"],[1,"my-2"],["for","email",1,"fw-bold"],["type","text","id","email","formControlName","email",1,"form-control"],[1,"alert","alert-danger","w-100","mt-1"],[1,"small","mb-3"],["type","submit",1,"btn-main","w-100","my-3",3,"disabled"],[1,"alert","alert-danger"],[1,"m-0"],["for","resetCode",1,"fw-bold"],["type","text","id","resetCode","formControlName","resetCode",1,"form-control"],["for","email"],["readonly","","type","text","id","email","formControlName","email",1,"form-control",3,"ngClass"],["for","newPassword"],["type","password","id","newPassword","formControlName","newPassword",1,"form-control"]],template:function(d,s){d&1&&(n(0,"section")(1,"div",0)(2,"h4",1),l(3,"Forgot your password"),i(),u(4,j,11,4,"form",2)(5,J,9,4)(6,ee,14,9),i()()),d&2&&(a(4),_(4,s.step==1?4:s.step==2?5:s.step==3?6:-1))},dependencies:[G,q,T,V,M,N,R,S]});let o=r;return o})();export{de as ForgotPasswordComponent};
